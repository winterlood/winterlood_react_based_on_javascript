# WEB의 이해 서버와 클라이언트, 렌더링

## 01. WEB은 도대체 어떻게 동작하는가?

우리가 접속하고 사용하는 수 많은 웹사이트들은 어떻게 만들어지고, 우리의 브라우저인 크롬까지 어떻게 도달하게 되는 걸까요?

웹은 기본적으로 HTML문서이자 파일입니다. 우리가 브라우저를 통해, 특정 웹사이트에 접속한다는 뜻은 곧 브라우저가 특정 웹사이트의 HTML 문서 파일을 다운로드 받았고, 이 HTML 코드를 시각적으로 분석하여 우리에게 보여주었다는 뜻 입니다.

![](https://user-images.githubusercontent.com/46296754/139524832-684893fc-b045-4735-b5ce-2896042d2dfa.png)

위의 그림을 단계별로 설명해보자면 아래와 같습니다.

1. 요청 : 우리는 `WebClient`인 크롬 브라우저의 주소입력창에 https://winterlood.com 을 입력하여 접속시도합니다. 이때 요청을 하게된 `WebClient`는 응답값을 받기까지 대기합니다.

2. 내부 처리 : https://winterlood.com 이라는 도메인을 점유한 `WebServer`는 이 요청에 응답하기 위해 적절한 결과물을 만들어냅니다. 이때의 결과물은 웹 문서인 HTML 파일이 됩니다.

3. 응답 : `WebServer`는 내부처리된 결과물인 웹 문서인 HTML파일을 요청자인 `WebClient`에게 전송하고, `WebClient`는 응답 HTML파일을 받아 표시합니다.

## 02. WEB 페이지 이동은 어떻게 되는건가요?

위에서 우리는 도메인(문자열로 사용하는 웹사이트 주소)을 통해 웹서버로 부터 도메인에 따른, 적절한 웹 HTML 문서를 받아 브라우저를 통해 웹사이트를 이용할 수 있다는 것을 알았습니다.

일단 접속하는 원리는 알았습니다만 페이지 이동은 어떻게 되는걸까요?

페이지 이동도 기본적으로는 페이지 접속과 크게 다를것은 없습니다.

결국 페이지를 이동한다는 것 또한, 또 다른 주소를 갖는 페이지를 요청한다는 것과 동일합니다.

예를들면 이런식입니다.

- https://winterlood.com <- 이 주소는 제 홈페이지의 인덱스(첫 화면)주소입니다.

- https://winterlood.com/post/1 <- 이 주소는 제 홈페이지의 여러 글 중, 1이라는 글의 페이지 즉, 1이라는 아이디를 갖는 페이지의 주소입니다.

위 두 주소 모두 각각의 페이지를 가지고 있습니다.

여기서 제가 첫 화면(인덱스 페이지)에서 1번 글을 보기위해 `~/post/1`의 주소를 가진 페이지로 이동하면, 브라우저는 기존의 주소에 `post/1`을 붙인 주소로 요청을 보냅니다.

즉 https://winterlood.com/post/1 에 요청을 하게 되는 것 입니다.

이렇게 페이지의 이동은 요청주소의 변경과도 같습니다.

우리는 보통 같은 사이트 내에서의 페이지 변경을 페이지 이동이라고 합니다. `winterlood.com` 에서 `winterlood.com/post/1` 처럼 도메인은 동일하지만, 세부 주소가 다를때를 이야기 하는 것이죠

![](https://user-images.githubusercontent.com/46296754/139525410-c3aa89b5-a999-462d-9ace-bde94109fa6d.png)

페이지 이동, 변경 과정은 간단하게 위 그림을 통해 이해할 수 있습니다.

1번부터 5번까지는 위와 동일한 내용이므로 생략하고 6번부터 설명하겠습니다.

1. 이미 접속된 페이지의 첫화면(index)에서 Mypage 버튼을 클릭합니다. 우리는 이런 버튼을 클릭하면 보통 마이페이지로 이동한다는 것을 알고있습니다.

2. 웹 브라우저는 `/mypage`를 붙여 요청을 보냅니다. 즉 새로운 주소로 요청을 보내게 되는 것 입니다.

3. 다른 주소로 요청을 하였으니 동일한 서버라도 다른 결과값을 생성합니다 `mypage.html`을 생성합니다.

4. 이렇게 생성된 `mypage.html`을 웹 브라우저에 전달합니다.

5. 마이페이지에 접속됩니다.

## 03. MPA

보통 웹사이트들은 여러개의 페이지(Multipage)를 가지고 있습니다.

쇼핑몰의 경우에도 인덱스 페이지, 상품 리스트페이지, 상품 정보 페이지 등등.. 엄청나게 많은 페이지를 가지고 있습니다.

웹사이트를 개발할 때, 전통적으로는 우리가 위에서 설명한 페이지 이동 방식 처럼 각각의 페이지 이동마다 해당 페이지를 요청하는 방식을 사용하게 됩니다.

![](https://user-images.githubusercontent.com/46296754/139531181-26e8e1c0-7e02-4d0f-ab86-8b3cba62f159.png)

페이지 이동마다 해당 페이지를 서버에 요청하는 이러한 전통적인 방식의 웹 어플리케이션을 `MultiPageApplication` 이라고 부릅니다.

이런 페이지 이동 방식은 마치 먹고싶은게 생길때 마다 마트에 가는것과 유사합니다.

위 그림처럼 `Multipage Application` 줄여서 `MPA`는 이렇게 페이지가 이동시에 새로운 페이지(웹 HTML문서)를 웹서버에게 요청하고, 응답을 받으면 브라우저가 마치 새로고침되듯 깜빡이며 페이지 이동을 하게 됩니다.

## 04. SPA

우리가 배우고있는 React는 SPA(Single Page Application)입니다.

SPA(Single Page Application)란 단일 페이지 어플리케이션 이라는 뜻으로 말 그대로 정말 페이지가 한개 짜리라는 뜻 입니다.

페이지 이동을 하고싶어, 웹서버에게 새로운 페이지를 요청하려고 해도 정말 페이지가 하나밖에 없으니 주고싶어도 웹서버도 줄수가 없습니다.

그러면 React로 개발된 웹 어플리케이션은 SPA(Single Page Application)이기 때문에 페이지 이동을 할 수 없을까요?

사실은 React는 단일 페이지 어플리케이션이지만 페이지이동은 할 수 있습니다. 그러나 그 기본은 단일페이지이기 때문에 페이지를 이동한다고 해도 웹서버에게 페이지를 새로 요청하지는 않습니다.

어떻게 이럴수 있을까요? React는 아래에서 설명할 `CSR(Client Side Render)`방식을 통해 동작하기 때문입니다.

## 04. CSR & SSR

### 4-1. SSR

전통적으로 개발된 웹어플리케이션 `MPA`는 페이지 이동시마다 새로운 페이지를 요청하게됩니다.

만약 이때, 마치 배달음식처럼, 주문하면 음식이 완성되어 오는 것 처럼 우리는 그냥 포장을 뜯고 먹으면 되듯이 서버에서 완성된 웹 문서를 보내주게되면 브라우저는 이 웹 문서를 그냥 사용자에게 보여주면 됩니다.

이러한 방식은 `Serverside Render`라고 합니다. 서버에서 이미 렌더링을 끝내서 가져다 준다는 의미입니다.

`SSR(Serverside Render)`웹 서버는 항상 완성된 웹페이지를 전달해줍니다. 웹 클라이언트 (브라우저)의 입장에서 보면 아래와 같습니다.

![](https://user-images.githubusercontent.com/46296754/139563959-effaf506-7814-46b0-8f9e-6661d5ae82d8.png)

브라우저는 그냥 요청하고, HTML을 받으면 끝납니다. 이미 다 만들어져 있는 HTML을 보내주기 때문입니다.

브라우저의 입장에서 보면 매우 간편하겠지만, 웹 서버 차원에서 보면 100% 좋은 방법은 아닙니다. 1초에 수만건의 웹 페이지 요청이 들어올텐데 이 웹페이지들을 다 완성시키기 위해서는 수 많은 연산이 필요합니다.

배달 전문 가게에서 동시에 주문이 10건 들어온 상황과 유사하다고 할 수 있습니다. 받아서 먹는 입장에서는 편하지만, 가게 사장님 입장에서는 죽을맛입니다.

따라서 서버에 부하가 발생했을 경우 우리는 페이지 이동시 빈 화면에서 꽤나 오래 기다려야 하며, 서버의 응답이 점점 느려지니 페이지 이동속도가 느려질 수 밖에 없습니다.

### 4-2. CSR

이러한 페이지 이동을 더 빠르고 자연스럽게 해주는 방법이 있습니다.

매우 간단한 방법인데요, 페이지 이동시마다 요청하지 말고 그냥 모든 페이지를 다 가지고 시작하는 방법입니다.

그리고 페이지가 이동되었을 때는 페이지 전체를 요청하는것이 아닌 필요한 데이터만 따로 요청합니다.

만약 해당 페이지에 별다른 데이터가 필요하지 않다면 아무것도 요청하지 않습니다.

이러한 방식은 배달음식이 아니라, 밀키트를 주문하는 것과 유사합니다. 음식에 필요한 재료만 그냥 포장해서 보내주면 내가 직접 음식을 해먹는 것입니다.

가게 사장은 주문이 많아도 걱정할 필요 없습니다. 그냥 소분해둔 재료를 담아 보내주기만 하면 되는 일이니까요 따라서 배달이 밀려 시간이 오래걸릴 일도 없습니다.

위에서 이야기 했던 SPA(단일 페이지 어플리케이션)는 이런 CSR방식을 사용하여 페이지 이동을 합니다.

![](https://user-images.githubusercontent.com/46296754/139563451-6b628767-64d9-412f-8a2d-576b7b5d98f2.png)

페이지 이동시에는 페이지 자체를 요청하는 것이 아닌, 그 페이지를 만드는데에 필요한 데이터만 요청합니다(보통은 json 형태로 요청)

즉 첫번째 접속을 제외한 모든 페이지 이동은 새로운 페이지를 요청하지 않습니다. 해당 페이지에 필요한 데이터만 요청합니다. 만약 해당 페이지에 필요한 데이터가 없다면 아무것도 요청하지 않습니다.
